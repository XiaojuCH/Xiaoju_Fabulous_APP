# Xiaoju App ç•Œé¢ä¿®æ”¹æŒ‡å—

## ğŸ“ ä¸»è¦ç•Œé¢æ–‡ä»¶ä½ç½®

### 1. è´¦å•é¡µé¢ (ExpensesScreen)
**æ–‡ä»¶è·¯å¾„**: `lib/screens/expenses_screen.dart`

**åŒ…å«å†…å®¹**:
- ç»Ÿè®¡æ ‡ç­¾é¡µ - æ˜¾ç¤ºé¢„ç®—ã€æ€»æ”¯å‡ºã€æ€»æ”¶å…¥ã€ç»“ä½™ã€å›¾è¡¨ç­‰
- æ˜ç»†æ ‡ç­¾é¡µ - æ˜¾ç¤ºè´¦å•åˆ—è¡¨ï¼Œå¯ä»¥ç‚¹å‡»ä¿®æ”¹åˆ†ç±»
- é¥¼å›¾ (ç¬¬ 583-717 è¡Œ)
- æŠ˜çº¿å›¾ (ç¬¬ 719-790 è¡Œ)

**å¸¸è§ä¿®æ”¹**:
```dart
// ä¿®æ”¹ç»Ÿè®¡å¡ç‰‡ (ç¬¬ 214-289 è¡Œ)
Widget _buildStatsCard(ExpenseStats stats) { ... }

// ä¿®æ”¹é¥¼å›¾æ ·å¼/é¢œè‰² (ç¬¬ 583-717 è¡Œ)
Widget _buildCategoryPieChart(ExpenseStats stats) {
  final colors = [
    const Color(0xFFFB8072), // æ·¡çº¢è‰²
    const Color(0xFF80B1D3), // æ·¡è“è‰²
    // ... ä¿®æ”¹è¿™é‡Œçš„é¢œè‰²
  ];
}

// ä¿®æ”¹æŠ˜çº¿å›¾ (ç¬¬ 719-790 è¡Œ)
Widget _buildTrendLineChart(ExpenseStats stats) { ... }
```

---

### 2. è®¾ç½®é¡µé¢ (SettingsScreen)
**æ–‡ä»¶è·¯å¾„**: `lib/screens/settings_screen.dart`

**åŒ…å«å†…å®¹**:
- API å¯†é’¥è®¾ç½® (ç¬¬ 109-151 è¡Œ)
- æ¯æœˆé¢„ç®—è®¾ç½® (ç¬¬ 156-205 è¡Œ)
- å…³äºä¿¡æ¯ (ç¬¬ 210-235 è¡Œ)
- æƒé™è¯´æ˜ (ç¬¬ 238-278 è¡Œ)

**å¸¸è§ä¿®æ”¹**:
```dart
// ä¿®æ”¹åº”ç”¨ç‰ˆæœ¬å· (ç¬¬ 216 è¡Œ)
subtitle: const Text('Xiaoju v1.0.4'),

// ä¿®æ”¹ç½‘ç«™åœ°å€ (ç¬¬ 222 è¡Œ)
subtitle: const Text('https://www.xiaojuch.com'),

// ä¿®æ”¹é¢„ç®—è¾“å…¥æ¡†æ ·å¼ (ç¬¬ 176-185 è¡Œ)
TextField(
  controller: _budgetController,
  keyboardType: TextInputType.number,
  decoration: const InputDecoration(
    labelText: 'é¢„ç®—é‡‘é¢ï¼ˆå…ƒï¼‰',
    // ... ä¿®æ”¹è¿™é‡Œ
  ),
)
```

---

### 3. ä¸Šä¼ é¡µé¢ (HomeScreen)
**æ–‡ä»¶è·¯å¾„**: `lib/screens/home_screen.dart`

**åŒ…å«å†…å®¹**:
- æ–‡ä»¶é€‰æ‹©å’Œä¸Šä¼ åŠŸèƒ½
- ä¸Šä¼ ç»“æœæ˜¾ç¤º

**å¸¸è§ä¿®æ”¹**:
```dart
// ä¿®æ”¹é¡µé¢æ ‡é¢˜ (ç¬¬ 14 è¡Œ)
title: const Text('Xiaoju'),
```

---

### 4. ä¸»å…¥å£å’Œå¯¼èˆª (MainScreen)
**æ–‡ä»¶è·¯å¾„**: `lib/main.dart`

**åŒ…å«å†…å®¹**:
- åº”ç”¨æ ‡é¢˜ (ç¬¬ 39 è¡Œ)
- åº•éƒ¨å¯¼èˆªæ  (ç¬¬ 77-97 è¡Œ)
- **é»˜è®¤æ‰“å¼€ç•Œé¢è®¾ç½®** (ç¬¬ 59 è¡Œ)

**å¸¸è§ä¿®æ”¹**:
```dart
// ä¿®æ”¹åº”ç”¨æ ‡é¢˜ (ç¬¬ 39 è¡Œ)
title: 'Xiaoju',

// ä¿®æ”¹ä¸»é¢˜é¢œè‰² (ç¬¬ 41 è¡Œ)
colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),

// ä¿®æ”¹åº•éƒ¨å¯¼èˆªæ æ ‡ç­¾ (ç¬¬ 80-95 è¡Œ)
destinations: const [
  NavigationDestination(
    icon: Icon(Icons.upload_outlined),
    selectedIcon: Icon(Icons.upload),
    label: 'ä¸Šä¼ ',
  ),
  NavigationDestination(
    icon: Icon(Icons.receipt_long_outlined),
    selectedIcon: Icon(Icons.receipt_long),
    label: 'è´¦å•',
  ),
  NavigationDestination(
    icon: Icon(Icons.settings_outlined),
    selectedIcon: Icon(Icons.settings),
    label: 'è®¾ç½®',
  ),
],
```

---

## ğŸ¯ è®¾ç½®é»˜è®¤æ‰“å¼€ç•Œé¢

### æ–¹æ³• 1: ä¿®æ”¹åˆå§‹é€‰ä¸­ç´¢å¼•ï¼ˆæ¨èï¼‰

åœ¨ `lib/main.dart` æ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ° `_MainScreenState` ç±»ï¼š

```dart
class _MainScreenState extends State<MainScreen> {
  int _selectedIndex = 0;  // â† ä¿®æ”¹è¿™é‡Œï¼

  // 0 = ä¸Šä¼ é¡µé¢ï¼ˆé»˜è®¤ï¼‰
  // 1 = è´¦å•é¡µé¢
  // 2 = è®¾ç½®é¡µé¢
```

**ç¤ºä¾‹**:
```dart
// é»˜è®¤æ‰“å¼€è´¦å•é¡µé¢
int _selectedIndex = 1;

// é»˜è®¤æ‰“å¼€è®¾ç½®é¡µé¢
int _selectedIndex = 2;
```

**æ–‡ä»¶ä½ç½®**: `lib/main.dart` ç¬¬ 59 è¡Œ

---

### æ–¹æ³• 2: ä¿®æ”¹é¡µé¢é¡ºåº

å¦‚æœæƒ³æ”¹å˜åº•éƒ¨å¯¼èˆªæ çš„é¡ºåºï¼Œä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹ï¼š

**1. ä¿®æ”¹é¡µé¢åˆ—è¡¨é¡ºåº** (ç¬¬ 61-65 è¡Œ):
```dart
static const List<Widget> _screens = [
  HomeScreen(),      // ç´¢å¼• 0
  ExpensesScreen(),  // ç´¢å¼• 1
  SettingsScreen(),  // ç´¢å¼• 2
];
```

**2. ä¿®æ”¹å¯¼èˆªæ å›¾æ ‡é¡ºåº** (ç¬¬ 80-95 è¡Œ):
```dart
destinations: const [
  NavigationDestination(...),  // ç´¢å¼• 0
  NavigationDestination(...),  // ç´¢å¼• 1
  NavigationDestination(...),  // ç´¢å¼• 2
],
```

**æ³¨æ„**: ä¸¤ä¸ªåˆ—è¡¨çš„é¡ºåºå¿…é¡»ä¸€è‡´ï¼

---

## ğŸ¨ é¥¼å›¾äº¤äº’æ•ˆæœè¯´æ˜

### å½“å‰äº¤äº’è¡Œä¸º
1. **è§¦æ‘¸é¥¼å›¾æ‰‡åŒºæ—¶**:
   - æ‰‡åŒºä¼šæ”¾å¤§ï¼ˆåŠå¾„ä» 80 å¢åŠ åˆ° 90ï¼‰
   - é¥¼å›¾ä¸Šæ–¹æ˜¾ç¤ºå¸¦é¢œè‰²è¾¹æ¡†çš„ä¿¡æ¯æ¡†
   - ä¿¡æ¯æ¡†æ˜¾ç¤ºï¼šåˆ†ç±»åç§°å’Œé‡‘é¢

2. **æ¾å¼€æˆ–ç§»å‡ºæ‰‡åŒºæ—¶**:
   - æ‰‡åŒºæ¢å¤åŸå¤§å°
   - ä¿¡æ¯æ¡†æ¶ˆå¤±

### ç›¸å…³ä»£ç ä½ç½®
- **è§¦æ‘¸çŠ¶æ€å˜é‡**: `lib/screens/expenses_screen.dart` ç¬¬ 16 è¡Œ
  ```dart
  int _touchedPieIndex = -1;
  ```

- **æ‰‡åŒºæ”¾å¤§æ•ˆæœ**: ç¬¬ 557 è¡Œ
  ```dart
  radius: isTouched ? 90 : 80,  // è§¦æ‘¸æ—¶æ”¾å¤§
  ```

- **ä¿¡æ¯æ¡†æ˜¾ç¤º**: ç¬¬ 508-541 è¡Œ
  ```dart
  if (_touchedPieIndex >= 0 && _touchedPieIndex < sortedCategories.length)
    Container(
      // æ˜¾ç¤ºåˆ†ç±»ä¿¡æ¯
    )
  ```

- **è§¦æ‘¸å›è°ƒå¤„ç†**: ç¬¬ 567-579 è¡Œ
  ```dart
  pieTouchData: PieTouchData(
    touchCallback: (FlTouchEvent event, pieTouchResponse) {
      setState(() {
        // æ›´æ–°è§¦æ‘¸ç´¢å¼•
      });
    },
  ),
  ```

### å¦‚ä½•ä¿®æ”¹äº¤äº’æ•ˆæœ

**1. ä¿®æ”¹æ”¾å¤§å¹…åº¦**:
```dart
// ç¬¬ 557 è¡Œ
radius: isTouched ? 100 : 80,  // æ”¹ä¸º 100 ä¼šæ”¾å¤§æ›´å¤š
```

**2. ç¦ç”¨è§¦æ‘¸æ•ˆæœ**:
```dart
// ç¬¬ 567 è¡Œï¼Œåˆ é™¤æˆ–æ³¨é‡Šæ‰ pieTouchData
pieTouchData: PieTouchData(enabled: false),
```

**3. ä¿®æ”¹ä¿¡æ¯æ¡†æ ·å¼**:
```dart
// ç¬¬ 510-517 è¡Œ
decoration: BoxDecoration(
  color: colors[_touchedPieIndex % colors.length].withOpacity(0.2),  // ä¿®æ”¹é€æ˜åº¦
  borderRadius: BorderRadius.circular(12),  // ä¿®æ”¹åœ†è§’
  border: Border.all(
    color: colors[_touchedPieIndex % colors.length],
    width: 3,  // ä¿®æ”¹è¾¹æ¡†å®½åº¦
  ),
),
```

---

## ğŸ”§ å…¶ä»–å¸¸è§ä¿®æ”¹

### ä¿®æ”¹åº”ç”¨åç§°
éœ€è¦ä¿®æ”¹ 3 ä¸ªåœ°æ–¹ï¼š

1. **ä¸»æ ‡é¢˜**: `lib/main.dart` ç¬¬ 39 è¡Œ
   ```dart
   title: 'Xiaoju',
   ```

2. **é¦–é¡µæ ‡é¢˜**: `lib/screens/home_screen.dart` ç¬¬ 14 è¡Œ
   ```dart
   title: const Text('Xiaoju'),
   ```

3. **Android åº”ç”¨å**: `android/app/src/main/AndroidManifest.xml` ç¬¬ 19 è¡Œ
   ```xml
   android:label="Xiaoju"
   ```

---

### ä¿®æ”¹ä¸»é¢˜é¢œè‰²
åœ¨ `lib/main.dart` ç¬¬ 41 è¡Œï¼š

```dart
// è“è‰²ä¸»é¢˜ï¼ˆå½“å‰ï¼‰
colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),

// ç´«è‰²ä¸»é¢˜
colorScheme: ColorScheme.fromSeed(seedColor: Colors.purple),

// ç»¿è‰²ä¸»é¢˜
colorScheme: ColorScheme.fromSeed(seedColor: Colors.green),

// è‡ªå®šä¹‰é¢œè‰²
colorScheme: ColorScheme.fromSeed(seedColor: Color(0xFF667eea)),
```

---

### ä¿®æ”¹é¥¼å›¾é…è‰²
åœ¨ `lib/screens/expenses_screen.dart` ç¬¬ 477-490 è¡Œï¼š

```dart
final colors = [
  const Color(0xFFFB8072), // æ·¡çº¢è‰²ï¼ˆè¾ƒæ·±ï¼‰
  const Color(0xFF80B1D3), // æ·¡è“è‰²ï¼ˆè¾ƒæ·±ï¼‰
  const Color(0xFF8DD3C7), // æ·¡é’è‰²ï¼ˆè¾ƒæ·±ï¼‰
  // ... æ·»åŠ æˆ–ä¿®æ”¹é¢œè‰²
];
```

**é…è‰²å»ºè®®**:
- ä½¿ç”¨ 12 ç§ä¸åŒçš„é¢œè‰²ä»¥æ”¯æŒæ›´å¤šåˆ†ç±»
- ä»æ·±åˆ°æµ…æ’åˆ—ï¼Œä¸»è¦åˆ†ç±»ä½¿ç”¨æ·±è‰²
- ä¿æŒæŸ”å’Œçš„è‰²è°ƒï¼Œé¿å…è¿‡äºé²œè‰³

---

## ğŸ“ æ•°æ®æ¨¡å‹æ–‡ä»¶

### Expense æ¨¡å‹
**æ–‡ä»¶è·¯å¾„**: `lib/models/expense.dart`

åŒ…å«ï¼š
- `Expense` - å•æ¡è´¦å•æ•°æ®
- `ExpenseStats` - ç»Ÿè®¡æ•°æ®
- `DailyTrend` - æ¯æ—¥è¶‹åŠ¿æ•°æ®

---

## ğŸŒ API æœåŠ¡

### API Service
**æ–‡ä»¶è·¯å¾„**: `lib/services/api_service.dart`

åŒ…å«æ‰€æœ‰ä¸åç«¯é€šä¿¡çš„æ–¹æ³•ï¼š
- `uploadBill()` - ä¸Šä¼ è´¦å•
- `getExpenses()` - è·å–è´¦å•åˆ—è¡¨
- `getExpenseStats()` - è·å–ç»Ÿè®¡ä¿¡æ¯
- `getCategories()` - è·å–åˆ†ç±»åˆ—è¡¨
- `updateExpenseCategory()` - æ›´æ–°è´¦å•åˆ†ç±»

---

## ğŸ”„ çŠ¶æ€ç®¡ç†

### ExpenseProvider
**æ–‡ä»¶è·¯å¾„**: `lib/providers/expense_provider.dart`

ç®¡ç†è´¦å•ç›¸å…³çš„çŠ¶æ€ï¼š
- è´¦å•åˆ—è¡¨
- ç»Ÿè®¡ä¿¡æ¯
- ç­›é€‰æ¡ä»¶
- åˆ†é¡µä¿¡æ¯

### UploadProvider
**æ–‡ä»¶è·¯å¾„**: `lib/providers/upload_provider.dart`

ç®¡ç†ä¸Šä¼ ç›¸å…³çš„çŠ¶æ€ï¼š
- ä¸Šä¼ è¿›åº¦
- ä¸Šä¼ ç»“æœ

---

## ğŸ’¡ å¼€å‘æç¤º

1. **ä¿®æ”¹åéœ€è¦çƒ­é‡è½½**: æŒ‰ `r` é”®æˆ–é‡æ–°è¿è¡Œåº”ç”¨
2. **ä¿®æ”¹é…ç½®æ–‡ä»¶åéœ€è¦å®Œå…¨é‡å¯**: å¦‚ `pubspec.yaml`ã€`AndroidManifest.xml`
3. **ä½¿ç”¨ VSCode**: æ¨èä½¿ç”¨ Flutter æ’ä»¶è¿›è¡Œå¼€å‘
4. **æŸ¥çœ‹æ—¥å¿—**: ä½¿ç”¨ `flutter logs` æŸ¥çœ‹åº”ç”¨æ—¥å¿—
5. **æ ¼å¼åŒ–ä»£ç **: ä½¿ç”¨ `dart format .` æ ¼å¼åŒ–æ‰€æœ‰ Dart æ–‡ä»¶

---

## ğŸ“¦ ä¾èµ–åŒ…

ä¸»è¦ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åŒ…ï¼ˆåœ¨ `pubspec.yaml` ä¸­ï¼‰ï¼š
- `provider` - çŠ¶æ€ç®¡ç†
- `dio` - HTTP è¯·æ±‚
- `fl_chart` - å›¾è¡¨åº“
- `file_picker` - æ–‡ä»¶é€‰æ‹©
- `shared_preferences` - æœ¬åœ°å­˜å‚¨

---

## ğŸ“± ç¼–è¯‘ APK å®‰è£…åŒ…

### å‰ç½®è¦æ±‚

åœ¨ç¼–è¯‘ APK ä¹‹å‰ï¼Œç¡®ä¿å·²ç»å®‰è£…ï¼š
- âœ… Flutter SDKï¼ˆå·²å®‰è£…å¹¶é…ç½®ç¯å¢ƒå˜é‡ï¼‰
- âœ… Android SDKï¼ˆé€šè¿‡ Android Studio æˆ–å‘½ä»¤è¡Œå·¥å…·å®‰è£…ï¼‰
- âœ… Java JDKï¼ˆæ¨è JDK 11 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰

**éªŒè¯ç¯å¢ƒ**:
```bash
flutter doctor
```

ç¡®ä¿ Android toolchain æ˜¾ç¤ºä¸ºç»¿è‰²å‹¾é€‰ã€‚

---

### æ–¹æ³• 1: ç¼–è¯‘è°ƒè¯•ç‰ˆ APKï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰

è°ƒè¯•ç‰ˆ APK ç¼–è¯‘é€Ÿåº¦å¿«ï¼Œé€‚åˆå¼€å‘æµ‹è¯•ä½¿ç”¨ã€‚

**æ­¥éª¤**:

1. **æ‰“å¼€ç»ˆç«¯**ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼š
   ```bash
   cd D:\My_Website\App\android-app
   ```

2. **æ¸…ç†ä¹‹å‰çš„æ„å»º**ï¼ˆå¯é€‰ä½†æ¨èï¼‰ï¼š
   ```bash
   flutter clean
   flutter pub get
   ```

3. **ç¼–è¯‘è°ƒè¯•ç‰ˆ APK**ï¼š
   ```bash
   flutter build apk --debug
   ```

4. **ç­‰å¾…ç¼–è¯‘å®Œæˆ**ï¼Œè¾“å‡ºæ–‡ä»¶ä½ç½®ï¼š
   ```
   build/app/outputs/flutter-apk/app-debug.apk
   ```

5. **å®‰è£…åˆ°æ‰‹æœº**ï¼š
   - æ–¹æ³• Aï¼šé€šè¿‡ USB è¿æ¥æ‰‹æœºï¼Œè¿è¡Œ `flutter install`
   - æ–¹æ³• Bï¼šå°† APK æ–‡ä»¶ä¼ è¾“åˆ°æ‰‹æœºï¼Œæ‰‹åŠ¨å®‰è£…

**ç‰¹ç‚¹**:
- âœ… ç¼–è¯‘é€Ÿåº¦å¿«ï¼ˆçº¦ 1-3 åˆ†é’Ÿï¼‰
- âœ… åŒ…å«è°ƒè¯•ä¿¡æ¯ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜
- âŒ APK ä½“ç§¯è¾ƒå¤§ï¼ˆçº¦ 40-60 MBï¼‰
- âŒ æ€§èƒ½ç•¥ä½äºæ­£å¼ç‰ˆ

---

### æ–¹æ³• 2: ç¼–è¯‘æ­£å¼ç‰ˆ APKï¼ˆæ¨èç”¨äºå‘å¸ƒï¼‰

æ­£å¼ç‰ˆ APK ç»è¿‡ä¼˜åŒ–å’Œæ··æ·†ï¼Œä½“ç§¯æ›´å°ï¼Œæ€§èƒ½æ›´å¥½ã€‚

**æ­¥éª¤**:

1. **æ‰“å¼€ç»ˆç«¯**ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼š
   ```bash
   cd D:\My_Website\App\android-app
   ```

2. **æ¸…ç†ä¹‹å‰çš„æ„å»º**ï¼š
   ```bash
   flutter clean
   flutter pub get
   ```

3. **ç¼–è¯‘æ­£å¼ç‰ˆ APK**ï¼š
   ```bash
   flutter build apk --release
   ```

4. **ç­‰å¾…ç¼–è¯‘å®Œæˆ**ï¼ˆé¦–æ¬¡ç¼–è¯‘çº¦ 5-10 åˆ†é’Ÿï¼‰ï¼Œè¾“å‡ºæ–‡ä»¶ä½ç½®ï¼š
   ```
   build/app/outputs/flutter-apk/app-release.apk
   ```

5. **é‡å‘½å APK**ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   # Windows
   copy build\app\outputs\flutter-apk\app-release.apk Xiaoju-v1.0.4.apk

   # Linux/Mac
   cp build/app/outputs/flutter-apk/app-release.apk Xiaoju-v1.0.4.apk
   ```

**ç‰¹ç‚¹**:
- âœ… APK ä½“ç§¯å°ï¼ˆçº¦ 15-25 MBï¼‰
- âœ… æ€§èƒ½ä¼˜åŒ–ï¼Œè¿è¡Œæµç•…
- âœ… ä»£ç æ··æ·†ï¼Œæé«˜å®‰å…¨æ€§
- âŒ ç¼–è¯‘æ—¶é—´è¾ƒé•¿
- âŒ æ— æ³•è°ƒè¯•

---

### æ–¹æ³• 3: ç¼–è¯‘åˆ†æ¶æ„ APKï¼ˆæœ€å°ä½“ç§¯ï¼‰

ä¸ºä¸åŒ CPU æ¶æ„åˆ†åˆ«ç¼–è¯‘ï¼Œæ¯ä¸ª APK ä½“ç§¯æœ€å°ã€‚

**æ­¥éª¤**:

```bash
flutter build apk --release --split-per-abi
```

**è¾“å‡ºæ–‡ä»¶**ï¼ˆåœ¨ `build/app/outputs/flutter-apk/` ç›®å½•ï¼‰ï¼š
- `app-armeabi-v7a-release.apk` - 32 ä½ ARMï¼ˆè€è®¾å¤‡ï¼‰
- `app-arm64-v8a-release.apk` - 64 ä½ ARMï¼ˆä¸»æµè®¾å¤‡ï¼‰
- `app-x86_64-release.apk` - 64 ä½ x86ï¼ˆæ¨¡æ‹Ÿå™¨ï¼‰

**ä½¿ç”¨å»ºè®®**:
- å¤§å¤šæ•°ç°ä»£æ‰‹æœºä½¿ç”¨ `arm64-v8a` ç‰ˆæœ¬
- æ¯ä¸ª APK ä½“ç§¯çº¦ 10-15 MB
- éœ€è¦æ ¹æ®è®¾å¤‡æ¶æ„é€‰æ‹©å¯¹åº”çš„ APK

---

### å¸¸è§é—®é¢˜

#### 1. ç¼–è¯‘å¤±è´¥ï¼šGradle ä¸‹è½½æ…¢

**è§£å†³æ–¹æ³•**ï¼šé…ç½®å›½å†…é•œåƒ

ç¼–è¾‘ `android/build.gradle`ï¼Œåœ¨ `repositories` ä¸­æ·»åŠ ï¼š
```gradle
maven { url 'https://maven.aliyun.com/repository/google' }
maven { url 'https://maven.aliyun.com/repository/jcenter' }
maven { url 'https://maven.aliyun.com/repository/public' }
```

#### 2. ç¼–è¯‘å¤±è´¥ï¼šå†…å­˜ä¸è¶³

**è§£å†³æ–¹æ³•**ï¼šå¢åŠ  Gradle å†…å­˜

ç¼–è¾‘ `android/gradle.properties`ï¼Œæ·»åŠ ï¼š
```properties
org.gradle.jvmargs=-Xmx2048m -XX:MaxPermSize=512m
```

#### 3. å®‰è£…å¤±è´¥ï¼šç­¾åå†²çª

**åŸå› **ï¼šæ‰‹æœºä¸Šå·²å®‰è£…äº†ä¸åŒç­¾åçš„åŒååº”ç”¨

**è§£å†³æ–¹æ³•**ï¼š
- å¸è½½æ—§ç‰ˆæœ¬åº”ç”¨
- æˆ–ä¿®æ”¹ `android/app/build.gradle` ä¸­çš„ `applicationId`

#### 4. ç½‘ç»œæƒé™é—®é¢˜

ç¡®ä¿ `android/app/src/main/AndroidManifest.xml` åŒ…å«ï¼š
```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
```

---

### å®‰è£… APK åˆ°æ‰‹æœº

#### æ–¹æ³• A: USB è¿æ¥å®‰è£…ï¼ˆæ¨èï¼‰

1. **å¯ç”¨å¼€å‘è€…é€‰é¡¹**ï¼š
   - è®¾ç½® â†’ å…³äºæ‰‹æœº â†’ è¿ç»­ç‚¹å‡»"ç‰ˆæœ¬å·" 7 æ¬¡
   - è¿”å›è®¾ç½® â†’ å¼€å‘è€…é€‰é¡¹ â†’ å¯ç”¨"USB è°ƒè¯•"

2. **è¿æ¥æ‰‹æœºåˆ°ç”µè„‘**ï¼Œå…è®¸ USB è°ƒè¯•

3. **éªŒè¯è¿æ¥**ï¼š
   ```bash
   flutter devices
   ```

4. **å®‰è£… APK**ï¼š
   ```bash
   flutter install
   # æˆ–
   adb install build/app/outputs/flutter-apk/app-release.apk
   ```

#### æ–¹æ³• B: æ‰‹åŠ¨å®‰è£…

1. **ä¼ è¾“ APK** åˆ°æ‰‹æœºï¼ˆé€šè¿‡ USBã€å¾®ä¿¡ã€QQ ç­‰ï¼‰

2. **åœ¨æ‰‹æœºä¸Šæ‰¾åˆ° APK æ–‡ä»¶**ï¼Œç‚¹å‡»å®‰è£…

3. **å…è®¸å®‰è£…æœªçŸ¥æ¥æºåº”ç”¨**ï¼ˆå¦‚æœç³»ç»Ÿæç¤ºï¼‰

---

### ç¼–è¯‘ä¼˜åŒ–å»ºè®®

#### 1. å‡å° APK ä½“ç§¯

åœ¨ `android/app/build.gradle` ä¸­å¯ç”¨ä»£ç å‹ç¼©ï¼š
```gradle
buildTypes {
    release {
        shrinkResources true
        minifyEnabled true
        proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
    }
}
```

#### 2. åŠ å¿«ç¼–è¯‘é€Ÿåº¦

```bash
# è·³è¿‡ä¸å¿…è¦çš„æ£€æŸ¥
flutter build apk --release --no-tree-shake-icons

# ä½¿ç”¨æœ¬åœ°ç¼“å­˜
flutter build apk --release --build-number=1 --build-name=1.0.4
```

#### 3. æŸ¥çœ‹ APK è¯¦ç»†ä¿¡æ¯

```bash
# æŸ¥çœ‹ APK å¤§å°
flutter build apk --release --analyze-size

# ç”Ÿæˆå¤§å°åˆ†ææŠ¥å‘Š
flutter build apk --release --target-platform android-arm64 --analyze-size
```

---

### ç‰ˆæœ¬å·ç®¡ç†

ä¿®æ”¹ç‰ˆæœ¬å·éœ€è¦ç¼–è¾‘ `pubspec.yaml`ï¼š

```yaml
version: 1.0.4+4
#        â†‘     â†‘
#        |     â””â”€ æ„å»ºå·ï¼ˆæ¯æ¬¡ç¼–è¯‘é€’å¢ï¼‰
#        â””â”€ ç‰ˆæœ¬åç§°ï¼ˆæ˜¾ç¤ºç»™ç”¨æˆ·ï¼‰
```

**ç¤ºä¾‹**:
```yaml
# å½“å‰ç‰ˆæœ¬
version: 1.0.4+4

# ä¸‹ä¸€ä¸ªç‰ˆæœ¬
version: 1.0.5+5
```

ä¿®æ”¹åé‡æ–°ç¼–è¯‘å³å¯ã€‚

---

### å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# è°ƒè¯•ç‰ˆï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰
flutter build apk --debug

# æ­£å¼ç‰ˆï¼ˆæ¨èï¼‰
flutter build apk --release

# åˆ†æ¶æ„ç‰ˆï¼ˆæœ€å°ä½“ç§¯ï¼‰
flutter build apk --release --split-per-abi

# æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘
flutter clean && flutter pub get && flutter build apk --release

# ç¼–è¯‘å¹¶å®‰è£…åˆ°æ‰‹æœº
flutter build apk --release && flutter install
```

---

**æœ€åæ›´æ–°**: 2025-12-14
**åº”ç”¨ç‰ˆæœ¬**: v1.0.4
